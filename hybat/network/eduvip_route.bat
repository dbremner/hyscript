@echo off

REM =====================================
REM
REM
REM
REM +++++++++++++++++++++++++++++++++++++
Setlocal ENABLEDELAYEDEXPANSION
REM 获取需要设置的网卡 interface
set OUT_IF=

set TARGET_IF_NAME="Realtek RTL8168C(P)/8111C(P) PCI-E Gigabit Ethernet NIC - VirtualBox Bridged Networking Driver Miniport"

if "xx%OUT_IF%"=="xx" (
    GOTO FETCH_IF_NAME
) else (
    GOTO FINISH_IF_NAME
)

:FETCH_IF_NAME

set IF_TMPDIR=%temp%\npp
IF EXIST %IF_TMPDIR% rmdir /S /Q %IF_TMPDIR% >NUL
mkdir %IF_TMPDIR%

route print >%IF_TMPDIR%\check.log 2>NUL

find %TARGET_IF_NAME% %IF_TMPDIR%\check.log >NUL

IF NOT ERRORLEVEL 1 (
 set isOK=true
) else (
 set isOK=false
)

REM set TEST_IF_NAME=
for /F "tokens=1 delims= " %%i in ('find %TARGET_IF_NAME% %IF_TMPDIR%\check.log') DO (
    
    set OUT_IF=%%i
    if "!OUT_IF:~0,2!"=="0x" GOTO FINISH_IF_NAME
)

:FINISH_IF_NAME
echo interface name: %OUT_IF%

REM 添加 ROUTE 信息
echo on
route -p ADD 58.192.0.0 MASK 255.240.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 59.64.0.0 MASK 255.240.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 121.48.0.0 MASK 255.254.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 121.192.0.0 MASK 255.252.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 125.216.0.0 MASK 255.248.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 162.105.0.0 MASK 255.255.0.0 166.111.36.1 IF %OUT_IF%
route -p add 59.66.197.0 mask 255.255.255.0 166.111.36.1 IF %OUT_IF%
route -p ADD 166.111.0.0 MASK 255.255.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.4.128.0 MASK 255.255.224.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.38.64.0 MASK 255.255.192.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.38.140.0 MASK 255.255.254.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.38.184.0 MASK 255.255.248.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.38.192.0 MASK 255.255.192.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.112.0.0 MASK 255.248.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.118.0.0 MASK 255.255.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.120.0.0 MASK 255.254.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.127.216.0 MASK 255.255.248.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.127.224.0 MASK 255.255.224.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.179.240.0 MASK 255.255.240.0 166.111.36.1 IF %OUT_IF%
route -p ADD 202.192.0.0 MASK 255.240.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 203.91.120.0 MASK 255.255.248.0 166.111.36.1 IF %OUT_IF%
route -p ADD 210.25.0.0 MASK 255.255.128.0 166.111.36.1 IF %OUT_IF%
route -p ADD 210.25.128.0 MASK 255.255.192.0 166.111.36.1 IF %OUT_IF%
route -p ADD 210.26.0.0 MASK 255.254.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 210.28.0.0 MASK 255.252.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 210.32.0.0 MASK 255.240.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 211.64.0.0 MASK 255.248.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 211.80.0.0 MASK 255.248.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 218.192.0.0 MASK 255.248.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 219.216.0.0 MASK 255.248.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 219.224.0.0 MASK 255.248.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 219.242.0.0 MASK 255.254.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 219.244.0.0 MASK 255.252.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 222.16.0.0 MASK 255.240.0.0 166.111.36.1 IF %OUT_IF%
route -p ADD 222.192.0.0 MASK 255.240.0.0 166.111.36.1 IF %OUT_IF%

route -p ADD 61.177.95.0 MASK 255.255.255.0 166.111.36.1 IF %OUT_IF%
route -p ADD 72.14.203.101 MASK 255.255.255.255 166.111.36.1 IF %OUT_IF%
route -p ADD 218.93.127.228 MASK 255.255.255.255 166.111.36.1 IF %OUT_IF%
route -p ADD 211.151.50.0 MASK 255.255.255.0 166.111.36.1 IF %OUT_IF%
route -p ADD 118.228.18.0 MASK 255.255.255.0 166.111.36.1 IF %OUT_IF%


:END
@pause
